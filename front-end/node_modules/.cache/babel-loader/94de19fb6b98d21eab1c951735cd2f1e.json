{"ast":null,"code":"import _regeneratorRuntime from \"/Users/yeezy/Desktop/projects/graphql-apollo/projects/movies2/front-end/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/yeezy/Desktop/projects/graphql-apollo/projects/movies2/front-end/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _taggedTemplateLiteral from \"/Users/yeezy/Desktop/projects/graphql-apollo/projects/movies2/front-end/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/yeezy/Desktop/projects/graphql-apollo/projects/movies2/front-end/src/components/AddToFavorites.js\";\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n    mutation($title: String!, $username: String!){\\n        favorite(title: $title, username: $username){\\n            title\\n        }\\n    }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n    mutation($title: String!, $movieDBId: Int!, $posterPath: String!){\\n        addMovie(title: $title, movieDBId: $movieDBId, posterPath: $posterPath){\\n            title\\n            posterPath\\n            movieDBId\\n        }\\n    }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React from 'react';\nimport gql from 'graphql-tag';\nimport { Mutation } from 'react-apollo';\nimport Error from './utils/Error';\nimport { CurrentUserQuery } from './auth/User';\nimport Unfavorite from './Unfavorite';\nvar AddMovie = gql(_templateObject());\nvar FavoriteMovie = gql(_templateObject2());\n\nvar AddToFavorites = function AddToFavorites(_ref) {\n  var movie = _ref.movie,\n      user = _ref.user;\n\n  var handleFavorite =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(addMovie, favorite) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return addMovie();\n\n            case 2:\n              _context.next = 4;\n              return favorite();\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function handleFavorite(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(Mutation, {\n    mutation: FavoriteMovie,\n    variables: {\n      title: movie.title,\n      username: user.username\n    },\n    refetchQueries: [{\n      query: CurrentUserQuery\n    }],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32\n    },\n    __self: this\n  }, function (favorite, _ref3) {\n    var loading = _ref3.loading;\n    return React.createElement(Mutation, {\n      mutation: AddMovie,\n      variables: {\n        title: movie.title,\n        movieDBId: movie.id,\n        posterPath: movie.poster_path\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42\n      },\n      __self: this\n    }, function (addMovie, _ref4) {\n      var loading = _ref4.loading,\n          error = _ref4.error;\n      var userFavIds = user.favorites.map(function (fav) {\n        return fav.movieDBId;\n      });\n      var alreadyFavorited = userFavIds.includes(movie.id);\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53\n        },\n        __self: this\n      }, alreadyFavorited ? React.createElement(Unfavorite, {\n        movie: movie,\n        user: user,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54\n        },\n        __self: this\n      }) : React.createElement(\"button\", {\n        onClick: function onClick() {\n          return handleFavorite(addMovie, favorite);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54\n        },\n        __self: this\n      }, \"Add\", loading ? \"ing\" : '', \" To Favorites\"), error && React.createElement(Error, {\n        err: error.message,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56\n        },\n        __self: this\n      }));\n    });\n  });\n};\n\nexport default AddToFavorites;","map":{"version":3,"sources":["/Users/yeezy/Desktop/projects/graphql-apollo/projects/movies2/front-end/src/components/AddToFavorites.js"],"names":["React","gql","Mutation","Error","CurrentUserQuery","Unfavorite","AddMovie","FavoriteMovie","AddToFavorites","movie","user","handleFavorite","addMovie","favorite","title","username","query","loading","movieDBId","id","posterPath","poster_path","error","userFavIds","favorites","map","fav","alreadyFavorited","includes","message"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,GAAP,MAAgB,aAAhB;AACA,SAASC,QAAT,QAAyB,cAAzB;AAEA,OAAOC,KAAP,MAAkB,eAAlB;AACA,SAASC,gBAAT,QAAiC,aAAjC;AACA,OAAOC,UAAP,MAAuB,cAAvB;AAEA,IAAMC,QAAQ,GAAGL,GAAH,mBAAd;AASA,IAAMM,aAAa,GAAGN,GAAH,oBAAnB;;AAQA,IAAMO,cAAc,GAAG,SAAjBA,cAAiB,OAAmB;AAAA,MAAjBC,KAAiB,QAAjBA,KAAiB;AAAA,MAAVC,IAAU,QAAVA,IAAU;;AACtC,MAAMC,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAG,iBAAOC,QAAP,EAAiBC,QAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACbD,QAAQ,EADK;;AAAA;AAAA;AAAA,qBAEbC,QAAQ,EAFK;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAdF,cAAc;AAAA;AAAA;AAAA,KAApB;;AAIF,SACI,oBAAC,QAAD;AACA,IAAA,QAAQ,EAAEJ,aADV;AAEA,IAAA,SAAS,EAAE;AACXO,MAAAA,KAAK,EAAEL,KAAK,CAACK,KADF;AAEXC,MAAAA,QAAQ,EAAEL,IAAI,CAACK;AAFJ,KAFX;AAMA,IAAA,cAAc,EAAE,CAAC;AAACC,MAAAA,KAAK,EAAEZ;AAAR,KAAD,CANhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAQC,UAACS,QAAD,SAAyB;AAAA,QAAbI,OAAa,SAAbA,OAAa;AACxB,WACF,oBAAC,QAAD;AAAU,MAAA,QAAQ,EAAEX,QAApB;AACA,MAAA,SAAS,EAAE;AACXQ,QAAAA,KAAK,EAAEL,KAAK,CAACK,KADF;AAEXI,QAAAA,SAAS,EAAET,KAAK,CAACU,EAFN;AAGXC,QAAAA,UAAU,EAAEX,KAAK,CAACY;AAHP,OADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAOC,UAACT,QAAD,SAAgC;AAAA,UAApBK,OAAoB,SAApBA,OAAoB;AAAA,UAAXK,KAAW,SAAXA,KAAW;AAC7B,UAAMC,UAAU,GAAGb,IAAI,CAACc,SAAL,CAAeC,GAAf,CAAmB,UAAAC,GAAG;AAAA,eAAIA,GAAG,CAACR,SAAR;AAAA,OAAtB,CAAnB;AACA,UAAMS,gBAAgB,GAAGJ,UAAU,CAACK,QAAX,CAAoBnB,KAAK,CAACU,EAA1B,CAAzB;AACA,aACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACCQ,gBAAgB,GAAG,oBAAC,UAAD;AAAY,QAAA,KAAK,EAAElB,KAAnB;AAA0B,QAAA,IAAI,EAAEC,IAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAH,GAA8C;AAAQ,QAAA,OAAO,EAAE;AAAA,iBAAMC,cAAc,CAACC,QAAD,EAAWC,QAAX,CAApB;AAAA,SAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAA+DI,OAAO,GAAG,KAAH,GAAW,EAAjF,kBAD/D,EAGGK,KAAK,IAAI,oBAAC,KAAD;AAAO,QAAA,GAAG,EAAEA,KAAK,CAACO,OAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHZ,CADJ;AAQH,KAlBD,CADE;AAqBE,GA9BJ,CADJ;AAkCD,CAvCD;;AAyCA,eAAerB,cAAf","sourcesContent":["import React from 'react';\nimport gql from 'graphql-tag';\nimport { Mutation } from 'react-apollo';\n\nimport Error from './utils/Error';\nimport { CurrentUserQuery } from './auth/User';\nimport Unfavorite from './Unfavorite';\n\nconst AddMovie = gql`\n    mutation($title: String!, $movieDBId: Int!, $posterPath: String!){\n        addMovie(title: $title, movieDBId: $movieDBId, posterPath: $posterPath){\n            title\n            posterPath\n            movieDBId\n        }\n    }\n`;\nconst FavoriteMovie = gql`\n    mutation($title: String!, $username: String!){\n        favorite(title: $title, username: $username){\n            title\n        }\n    }\n`;\n\nconst AddToFavorites = ({movie, user}) => {\n    const handleFavorite = async (addMovie, favorite) => {\n        await addMovie();\n        await favorite();\n    }\n  return (\n      <Mutation \n      mutation={FavoriteMovie}\n      variables={{\n      title: movie.title,\n      username: user.username\n      }}\n      refetchQueries={[{query: CurrentUserQuery}]}\n      >\n      {(favorite, {loading}) => {\n        return(\n      <Mutation mutation={AddMovie} \n      variables={{\n      title: movie.title, \n      movieDBId: movie.id, \n      posterPath: movie.poster_path,\n      }}\n      >\n      {(addMovie, {loading, error}) => {\n          const userFavIds = user.favorites.map(fav => fav.movieDBId);\n          const alreadyFavorited = userFavIds.includes(movie.id);\n          return(\n              <div>\n              {alreadyFavorited ? <Unfavorite movie={movie} user={user} /> : <button onClick={() => handleFavorite(addMovie, favorite)}>Add{loading ? \"ing\" : ''} To Favorites</button>\n              }\n                {error && <Error err={error.message}/>}\n              </div>\n            \n          )\n      }}\n      </Mutation>\n        )}}\n      </Mutation>\n  )\n}\n\nexport default AddToFavorites;"]},"metadata":{},"sourceType":"module"}